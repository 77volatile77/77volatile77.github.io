## STM32 USB Audio DAC


# Intro
I've always wanted an excuse to do a mixed-signal hardware design, so I thought of building a guitar pedal to implement some effects -- but well, I faked my way through band class for the entirety of middle school so that's not super optimal. What about a DAC? I was never really into the audiophile stuff, but I like the sound of building one of those audio DACs. I know of these pretty affordable IEM's, the Moondrop Quarks. They sound pretty good, and they're like 16Î© so pretty easy to drive. 

# Goals
For now, I just wanna get something working quickly. I think I'll consider this initial experiment a success if this DAC sounds... ok? As long as there arent artifacts that ruin the listening experience. It's worth noting that it's pretty hard to test this stuff, since audio analyzers are like upwards of $20k. Jonathan Fisher's blog covered this topic as well -- and he seemed to be able to get rough results with his Saleae. Also, learn USB Audio and DMA, since I've actually never used DMA in a proper project. I'm a bit busy doing hardware design for CWRU Baja, but it should be a fun challenge getting something done by the end of the semester.

# What do?
OK, there are multiple ways to do this. Generally, the overall system just takes USB Audio data and transfers it via I2S to the audio stage, which should just be a DAC and Amp chip I think. The easiest way would be to use a USB-I2S bridge, which would remove the need for a microcontroller altogether, but that's no fun. What I'll do is just have USB IN, use STM32's SAI to handle I2S/DMA for the DAC, leading to the amplifier stage (stereo out). I'm actually not totally sure if the amplifier is necessary? I have to do a bit more reading on this.

# MCU
I like STM32 since theyre relatively cheap, have tons of peripherals, perform well, and they just work. As far as families go, I just need something with I2S, SAI, USB (not crystal-less though, since timing for audio is a bit more critical). I think RAM is a parameter here (something to do with USB audio devices), if my browsing on this topic indicates anything. I've had good experiences with L431, but I'll keep looking. 

# Audio IC's 
I initially thought of using those fancy chips in commerical DAC's, like ES9038Q2M or AK4490 (ESS and AKM seem to be the popular ones), but these chips are either overkill or arent available. From what I've seen, PCM5102A (often paired with TPA6120A2 amplifier) seems like a popular choice amongst other people doing DIY DACs, as well as MAX98357, which is also a class D amplifier. <TODO: Write decision tree> 
